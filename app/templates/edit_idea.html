{% extends 'base.html' %}

{% block title %}Edit Idea ‚Äì Innovation Hub{% endblock %}

{% block head_extra %}
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
{% endblock %}

{% block content %}
  <h2 class="page-heading">üõ†Ô∏è Edit Idea</h2>

  <div class="card fade-in">
    <form method="POST" class="idea-form">
      {{ form.hidden_tag() }}

      <div class="form-group">
        <label>{{ form.title.label }}</label><br>
        {{ form.title(size=60, class="input-text") }}
        {% if form.title.errors %}
          <div class="error">{{ form.title.errors[0] }}</div>
        {% endif %}
      </div>

      <div class="form-group">
        <label>{{ form.description.label }}</label><br>
        <div id="quill-editor" style="height: 200px;"></div>
        {{ form.description(rows=6, cols=60, class="input-textarea", style="display:none;") }}
        {% if form.description.errors %}
          <div class="error">{{ form.description.errors[0] }}</div>
        {% endif %}
      </div>

      <div class="form-group">
        <label>{{ form.teammates.label }}</label><br>
        {{ form.teammates(class="input-text") }}
        {% if form.teammates.errors %}
          <div class="error">{{ form.teammates.errors[0] }}</div>
        {% endif %}
      </div>

      <div class="form-group">
        <label>{{ form.intent.label }}</label><br>
        {{ form.intent(class="input-text") }}
        {% if form.intent.errors %}
          <div class="error">{{ form.intent.errors[0] }}</div>
        {% endif %}
      </div>

      <div class="form-group checkbox-group">
        {{ form.is_anonymous() }}
        <label>{{ form.is_anonymous.label }}</label>
      </div>

      <div class="form-group">
        {{ form.submit(class="btn btn-primary") }}
      </div>
    </form>
  </div>

  <div class="back-link">
    <a href="{{ url_for('views.dashboard') }}">‚Üê Back to Dashboard</a>
  </div>
{% endblock %}

{% block scripts %}
  <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
  <script>
    var quill = new Quill('#quill-editor', {
      theme: 'snow',
      modules: {
        toolbar: [
          ['bold', 'italic', 'underline'],
          [{ list: 'bullet' }],
          [{ align: [] }],
          ['clean']
        ]
      }
    });

    // Populate editor with existing description
    quill.root.innerHTML = document.querySelector('textarea[name="description"]').value;

    document.querySelector('.idea-form').addEventListener('submit', function () {
      var descField = document.querySelector('textarea[name="description"]');
      descField.value = quill.root.innerHTML;
    });
  </script>
{% endblock %}
